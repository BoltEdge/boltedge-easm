import { AssetGroup, Asset, ScanResult, Finding, ScanJob } from "../types";

export const mockAssetGroups: AssetGroup[] = [
  {
    id: "group-1",
    name: "Production Infrastructure",
    assetCount: 5,
    ipCount: 1,
    domainCount: 3,
    emailCount: 1,
    createdAt: new Date("2024-01-15"),
  },
  {
    id: "group-2",
    name: "Development Environment",
    assetCount: 3,
    ipCount: 1,
    domainCount: 2,
    emailCount: 0,
    createdAt: new Date("2024-01-18"),
  },
  {
    id: "group-3",
    name: "Partner Domains",
    assetCount: 2,
    ipCount: 0,
    domainCount: 1,
    emailCount: 1,
    createdAt: new Date("2024-01-20"),
  },
];

export const mockAssets: Asset[] = [
  // -------- Group 1 (Production Infrastructure) --------
  {
    id: "asset-1",
    groupId: "group-1",
    type: "domain",
    value: "example.com",
    label: "Main Website",
    status: "completed",
    lastScan: new Date("2024-01-24T10:15:00"),
    lastScanAt: new Date("2024-01-24T10:15:00"),
    latestScanId: "job-1",
    severity: "low",
  },
  {
    id: "asset-2",
    groupId: "group-1",
    type: "ip",
    value: "192.168.1.100",
    label: "Web Server",
    status: "completed",
    lastScan: new Date("2024-01-23T14:30:00"),
    lastScanAt: new Date("2024-01-23T14:30:00"),
    latestScanId: "job-2",
    severity: "high",
  },
  {
    id: "asset-3",
    groupId: "group-1",
    type: "domain",
    value: "api.example.com",
    status: "running",
    latestScanId: "job-3",
  },
  {
    id: "asset-4",
    groupId: "group-1",
    type: "email",
    value: "admin@example.com",
    status: "queued",
    latestScanId: "job-8",
  },
  {
    id: "asset-5",
    groupId: "group-1",
    type: "domain",
    value: "mail.example.com",
    label: "Mail Server",
    status: "failed",
    lastScan: new Date("2024-01-22T09:00:00"),
    lastScanAt: new Date("2024-01-22T09:00:00"),
    latestScanId: "job-4",
  },

  // -------- Group 2 (Development Environment) --------
  {
    id: "asset-6",
    groupId: "group-2",
    type: "domain",
    value: "dev.example.com",
    status: "completed",
    lastScan: new Date("2024-01-24T11:00:00"),
    lastScanAt: new Date("2024-01-24T11:00:00"),
    latestScanId: "job-5",
    severity: "info",
  },
  {
    id: "asset-7",
    groupId: "group-2",
    type: "ip",
    value: "10.0.0.50",
    label: "Dev Database",
    status: "queued",
    latestScanId: "job-7",
  },
  {
    id: "asset-8",
    groupId: "group-2",
    type: "domain",
    value: "staging.example.com",
    status: "completed",
    lastScan: new Date("2024-01-23T16:45:00"),
    lastScanAt: new Date("2024-01-23T16:45:00"),
    latestScanId: "job-6",
    severity: "medium",
  },

  // -------- Group 3 (Partner Domains) --------
  {
    id: "asset-9",
    groupId: "group-3",
    type: "domain",
    value: "partner1.com",
    status: "not_scanned",
  },
  {
    id: "asset-10",
    groupId: "group-3",
    type: "email",
    value: "contact@partner2.com",
    status: "not_scanned",
  },
];

export const mockScanResults: ScanResult[] = [
  {
    id: "result-1",
    assetId: "asset-1",
    status: "completed",
    timestamp: new Date("2024-01-24T10:15:00"),
    summary: "Scan completed - Low severity findings",
    details:
      "All security checks passed. SSL certificate is valid, no open vulnerabilities detected.",
    severity: "low",
    findingsCount: 2,
  },
  {
    id: "result-2",
    assetId: "asset-2",
    status: "completed",
    timestamp: new Date("2024-01-23T14:30:00"),
    summary: "Scan completed - High severity findings",
    details: "Critical security issues detected. Immediate action required.",
    severity: "high",
    findingsCount: 3,
  },
  {
    id: "result-3",
    assetId: "asset-5",
    status: "failed",
    timestamp: new Date("2024-01-22T09:00:00"),
    summary: "Scan failed",
    details:
      "Unable to connect to target. The host may be down or blocking scan requests.",
  },
  {
    id: "result-4",
    assetId: "asset-6",
    status: "completed",
    timestamp: new Date("2024-01-24T11:00:00"),
    summary: "Scan completed - No issues",
    details:
      "Development environment appears secure. No critical vulnerabilities detected.",
    severity: "info",
    findingsCount: 0,
  },
  {
    id: "result-5",
    assetId: "asset-8",
    status: "completed",
    timestamp: new Date("2024-01-23T16:45:00"),
    summary: "Scan completed - Medium severity findings",
    details: "Security improvements recommended.",
    severity: "medium",
    findingsCount: 2,
  },
];

export const mockFindings: Finding[] = [
  {
    id: "finding-1",
    assetId: "asset-2",
    assetValue: "192.168.1.100",
    assetType: "ip",
    groupId: "group-1",
    severity: "critical",
    title: "Unauthenticated Remote Code Execution",
    description:
      "CVE-2024-1234: Remote code execution vulnerability detected in web service running on port 8080. Immediate patching required.",
    detectedAt: new Date("2024-01-23T14:30:00"),
    cve: "CVE-2024-1234",
    cvssScore: 9.8,
    affectedComponent: "Apache Tomcat 9.0.45",
    technicalDetails:
      "An unauthenticated attacker can exploit a deserialization vulnerability in the web service to execute arbitrary code on the server. The vulnerability exists due to improper input validation in the request handler, allowing malicious serialized objects to be processed without authentication.",
    recommendations: [
      "Immediately upgrade Apache Tomcat to version 9.0.62 or later",
      "Implement network segmentation to restrict access to port 8080",
      "Deploy a Web Application Firewall (WAF) with deserialization attack rules",
      "Enable security logging and monitor for exploitation attempts",
    ],
    remediationSteps: [
      "Back up the current Tomcat installation and application data",
      "Download Apache Tomcat version 9.0.62 or later from the official website",
      "Stop the Tomcat service",
      "Replace the vulnerable JAR files with patched versions",
      "Update the application configuration if required",
      "Restart the Tomcat service and verify functionality",
      "Verify the patch using a vulnerability scanner",
    ],
    references: [
      "https://nvd.nist.gov/vuln/detail/CVE-2024-1234",
      "https://tomcat.apache.org/security-9.html",
      "https://www.cisa.gov/known-exploited-vulnerabilities-catalog",
    ],
  },
  {
    id: "finding-2",
    assetId: "asset-2",
    assetValue: "192.168.1.100",
    assetType: "ip",
    groupId: "group-1",
    severity: "high",
    title: "SSH Port Exposed to Public",
    description:
      "Port 22 (SSH) is open to the public internet. Consider restricting access or implementing VPN/bastion host.",
    detectedAt: new Date("2024-01-23T14:30:00"),
    affectedComponent: "OpenSSH 8.2p1",
    technicalDetails:
      "The SSH service is accessible from any IP address on the internet without IP-based restrictions. This increases the attack surface and exposes the server to brute-force attacks, credential stuffing, and zero-day exploits targeting SSH vulnerabilities.",
    recommendations: [
      "Restrict SSH access to specific IP addresses or ranges using firewall rules",
      "Implement a VPN or bastion host for SSH access",
      "Use SSH key-based authentication and disable password authentication",
      "Enable fail2ban or similar intrusion prevention system",
      "Change the default SSH port to reduce automated scanning",
    ],
    remediationSteps: [
      "Configure firewall rules to allow SSH only from trusted IP addresses",
      "Update /etc/ssh/sshd_config to disable password authentication",
      "Generate and deploy SSH keys for all authorized users",
      "Install and configure fail2ban with SSH protection rules",
      "Restart the SSH service to apply changes",
      "Test SSH connectivity from authorized networks",
    ],
    references: [
      "https://www.ssh.com/academy/ssh/security",
      "https://www.cisecurity.org/benchmark/distribution_independent_linux",
    ],
  },
  {
    id: "finding-3",
    assetId: "asset-2",
    assetValue: "192.168.1.100",
    assetType: "ip",
    groupId: "group-1",
    severity: "high",
    title: "Outdated TLS Version",
    description:
      "Server supports TLS 1.0 and 1.1, which are deprecated and vulnerable. Update to TLS 1.2 or higher.",
    detectedAt: new Date("2024-01-23T14:30:00"),
    affectedComponent: "SSL/TLS Configuration",
    cvssScore: 7.5,
    technicalDetails:
      "The server is configured to accept TLS 1.0 and TLS 1.1 connections, both of which have known cryptographic weaknesses including vulnerability to BEAST, POODLE, and other attacks.",
    recommendations: [
      "Disable TLS 1.0 and TLS 1.1 in the server configuration",
      "Enable only TLS 1.2 and TLS 1.3",
      "Use strong cipher suites that support forward secrecy",
      "Test configuration using SSL Labs or similar tools",
    ],
    remediationSteps: [
      "Identify all services using TLS (web servers, load balancers, APIs)",
      "Update configuration to disable TLS 1.0 and 1.1",
      "Enable TLS 1.2 as minimum and TLS 1.3 if supported",
      "Restart affected services",
      "Test with SSL Labs",
    ],
    references: [
      "https://www.rfc-editor.org/rfc/rfc8996.html",
      "https://wiki.mozilla.org/Security/Server_Side_TLS",
    ],
  },
  {
    id: "finding-4",
    assetId: "asset-1",
    assetValue: "example.com",
    assetType: "domain",
    groupId: "group-1",
    severity: "low",
    title: "Missing Security Headers",
    description:
      "X-Frame-Options and X-Content-Type-Options headers are missing. Recommend implementing these security headers.",
    detectedAt: new Date("2024-01-24T10:15:00"),
    affectedComponent: "Web Server HTTP Headers",
    cvssScore: 3.7,
    technicalDetails:
      "The web application is missing critical security headers that protect against common web attacks.",
    recommendations: [
      "Add X-Frame-Options: DENY or SAMEORIGIN header",
      "Add X-Content-Type-Options: nosniff header",
      "Implement Content-Security-Policy for comprehensive protection",
    ],
    remediationSteps: [
      "Locate web server configuration file",
      "Add required headers",
      "Restart web server",
      "Verify headers using browser DevTools or curl -I",
    ],
    references: [
      "https://owasp.org/www-project-secure-headers/",
      "https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers",
    ],
  },
  {
    id: "finding-5",
    assetId: "asset-1",
    assetValue: "example.com",
    assetType: "domain",
    groupId: "group-1",
    severity: "low",
    title: "Content Security Policy Not Set",
    description:
      "No Content-Security-Policy header detected. Consider implementing CSP to prevent XSS attacks.",
    detectedAt: new Date("2024-01-24T10:15:00"),
    affectedComponent: "Web Application",
    cvssScore: 4.3,
    technicalDetails:
      "Content Security Policy (CSP) helps prevent cross-site scripting (XSS), clickjacking, and other code injection attacks.",
    recommendations: [
      "Implement a Content-Security-Policy header",
      "Start with report-only mode to identify legitimate resources",
      "Gradually tighten the policy",
    ],
    remediationSteps: [
      "Audit scripts/styles/resources used by the application",
      "Create initial CSP in report-only mode",
      "Monitor CSP reports and refine",
      "Switch to enforcement mode",
    ],
    references: [
      "https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP",
      "https://csp-evaluator.withgoogle.com/",
    ],
  },
  {
    id: "finding-6",
    assetId: "asset-8",
    assetValue: "staging.example.com",
    assetType: "domain",
    groupId: "group-2",
    severity: "medium",
    title: "Weak Cipher Suites Enabled",
    description:
      "Server accepts weak cipher suites that may be vulnerable to attacks. Update SSL/TLS configuration.",
    detectedAt: new Date("2024-01-23T16:45:00"),
    affectedComponent: "SSL/TLS Cipher Configuration",
    cvssScore: 5.9,
    technicalDetails:
      "The server accepts cipher suites using CBC mode and non-ephemeral key exchange.",
    recommendations: [
      "Disable all cipher suites using CBC mode",
      "Enable only AEAD cipher suites",
      "Ensure ephemeral key exchange (ECDHE)",
    ],
    remediationSteps: [
      "Review current cipher suite configuration",
      "Update server config to use modern cipher suite string",
      "Restart web server",
      "Validate with SSL Labs",
    ],
    references: [
      "https://ssl-config.mozilla.org/",
      "https://wiki.mozilla.org/Security/Server_Side_TLS",
    ],
  },
  {
    id: "finding-7",
    assetId: "asset-8",
    assetValue: "staging.example.com",
    assetType: "domain",
    groupId: "group-2",
    severity: "medium",
    title: "DNSSEC Not Enabled",
    description:
      "Domain is not protected by DNSSEC, which could allow DNS spoofing attacks.",
    detectedAt: new Date("2024-01-23T16:45:00"),
    affectedComponent: "DNS Configuration",
    cvssScore: 5.3,
    technicalDetails:
      "Without DNSSEC, DNS responses cannot be cryptographically verified, making the domain vulnerable to DNS hijacking.",
    recommendations: [
      "Enable DNSSEC at your domain registrar",
      "Add DS records to the parent zone",
      "Monitor DNSSEC validation status",
    ],
    remediationSteps: [
      "Enable DNSSEC support at registrar",
      "Generate keys and sign zone",
      "Publish DS records",
      "Verify using dig +dnssec",
    ],
    references: [
      "https://www.icann.org/resources/pages/dnssec-what-is-it-why-important-2019-03-05-en",
    ],
  },
  {
    id: "finding-8",
    assetId: "asset-1",
    assetValue: "example.com",
    assetType: "domain",
    groupId: "group-1",
    severity: "info",
    title: "HTTPS Service Detected",
    description:
      "HTTPS service is active on port 443. The server is properly configured with SSL/TLS encryption.",
    detectedAt: new Date("2024-01-24T10:15:00"),
    affectedComponent: "Web Server - Port 443",
    technicalDetails:
      "The HTTPS service on port 443 is responding correctly with valid SSL/TLS certificates.",
    recommendations: [
      "Continue monitoring certificate expiration dates",
      "Ensure automatic certificate renewal is configured",
    ],
  },
  {
    id: "finding-9",
    assetId: "asset-2",
    assetValue: "192.168.1.100",
    assetType: "ip",
    groupId: "group-1",
    severity: "info",
    title: "HTTP Service Detected",
    description:
      "HTTP service detected on port 80. Server is responding to web requests.",
    detectedAt: new Date("2024-01-23T14:30:00"),
    affectedComponent: "Web Server - Port 80",
    technicalDetails:
      "Standard HTTP service is active on port 80. Consider redirecting HTTP traffic to HTTPS.",
    recommendations: [
      "Verify HTTP to HTTPS redirect is properly configured",
      "Consider implementing HSTS",
    ],
  },
  {
    id: "finding-10",
    assetId: "asset-8",
    assetValue: "staging.example.com",
    assetType: "domain",
    groupId: "group-2",
    severity: "info",
    title: "Mail Server (SMTP) Detected",
    description: "SMTP service detected on port 25. Mail server is operational.",
    detectedAt: new Date("2024-01-23T16:45:00"),
    affectedComponent: "Mail Server - Port 25",
    technicalDetails:
      "Standard SMTP mail service is running on port 25. The server is accepting mail connections as expected.",
    recommendations: [
      "Ensure SPF, DKIM, and DMARC records are properly configured",
      "Monitor for unusual email traffic or spam activity",
    ],
  },
];

export const mockScanJobs: ScanJob[] = [
  {
    id: "job-1",
    assetId: "asset-1",
    assetValue: "example.com",
    assetType: "domain",
    groupId: "group-1",
    groupName: "Production Infrastructure",
    status: "completed",
    timeStarted: new Date("2024-01-24T10:15:00"),
    timeCompleted: new Date("2024-01-24T10:18:30"),
  },
  {
    id: "job-2",
    assetId: "asset-2",
    assetValue: "192.168.1.100",
    assetType: "ip",
    groupId: "group-1",
    groupName: "Production Infrastructure",
    status: "completed",
    timeStarted: new Date("2024-01-23T14:30:00"),
    timeCompleted: new Date("2024-01-23T14:35:15"),
  },
  {
    id: "job-3",
    assetId: "asset-3",
    assetValue: "api.example.com",
    assetType: "domain",
    groupId: "group-1",
    groupName: "Production Infrastructure",
    status: "running",
    timeStarted: new Date("2024-01-24T15:45:00"),
  },
  {
    id: "job-4",
    assetId: "asset-5",
    assetValue: "mail.example.com",
    assetType: "domain",
    groupId: "group-1",
    groupName: "Production Infrastructure",
    status: "failed",
    timeStarted: new Date("2024-01-22T09:00:00"),
    errorMessage:
      "Connection timeout: Unable to establish connection to target host after 30 seconds",
  },
  {
    id: "job-5",
    assetId: "asset-6",
    assetValue: "dev.example.com",
    assetType: "domain",
    groupId: "group-2",
    groupName: "Development Environment",
    status: "completed",
    timeStarted: new Date("2024-01-24T11:00:00"),
    timeCompleted: new Date("2024-01-24T11:03:45"),
  },
  {
    id: "job-6",
    assetId: "asset-8",
    assetValue: "staging.example.com",
    assetType: "domain",
    groupId: "group-2",
    groupName: "Development Environment",
    status: "completed",
    timeStarted: new Date("2024-01-23T16:45:00"),
    timeCompleted: new Date("2024-01-23T16:50:20"),
  },
  {
    id: "job-7",
    assetId: "asset-7",
    assetValue: "10.0.0.50",
    assetType: "ip",
    groupId: "group-2",
    groupName: "Development Environment",
    status: "queued",
    timeStarted: new Date("2024-01-24T16:00:00"),
  },
  {
    id: "job-8",
    assetId: "asset-4",
    assetValue: "admin@example.com",
    assetType: "email",
    groupId: "group-1",
    groupName: "Production Infrastructure",
    status: "queued",
    timeStarted: new Date("2024-01-24T16:15:00"),
  },
    {
    id: "job-7",
    assetId: "asset-7",
    status: "queued",
    timeStarted: new Date("2024-01-24T16:00:00"),
    timeCompleted: null,
    findingsCount: 0,
  },
  {
    id: "job-8",
    assetId: "asset-4",
    status: "queued",
    timeStarted: new Date("2024-01-24T16:15:00"),
    timeCompleted: null,
    findingsCount: 0,
  },

];
